<template>   <header     :class="[       colors.background,       {'border-b': settings.theme === 'light'},       {'relative sticky top-0 z-50': settings.sticky}     ]"   >     <a :id="`basic-header-${index}`"></a>     <nav class="mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8" aria-label="Global">       <div v-if="settings.logo?.filename || settings.title" class="flex lg:flex-1">         <a href="/" class="-m-1.5 p-1.5 flex items-center gap-3">           <img v-if="settings.logo?.filename" :src="getResizeUrl(settings.logo, {height: 128})" class="h-8 w-auto" alt="">           <span v-if="settings.title && settings.show_title" :class="colors.text" class="font-semibold" v-text="settings.title" />         </a>       </div>       <template v-if="menuItems.length">         <div class="flex lg:hidden">           <button @click="mobileMenuOpen = !mobileMenuOpen" type="button" :class="colors.text" class="-m-2.5 inline-flex items-center justify-center rounded-md p-2.5">             <span class="sr-only">Open main menu</span>             <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">               <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />             </svg>           </button>         </div>         <div class="hidden lg:flex lg:gap-x-12">           <template v-for="(item, index) in menuItems" :key="index">             <div v-if="item.children.length" class="relative">               <button @click="toggleSubmenu(item.id)" type="button" :class="colors.text" class="flex items-center gap-x-1 text-sm font-semibold leading-6" aria-expanded="false">                 {{ item.title }}                 <svg :class="colors.text_light" class="h-5 w-5 flex-none" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">                   <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />                 </svg>               </button>                <transition enter-active-class="transition ease-out duration-200" enter-from-class="opacity-0 translate-y-1" enter-to-class="opacity-100 translate-y-0" leave-active-class="transition ease-in duration-150" leave-from-class="opacity-100 translate-y-0" leave-to-class="opacity-0 translate-y-1">                 <div                   :ref="`submenu-${item.id}`"                   v-show="activeSubmenu === item.id"                   :class="submenuPositions[item.id]"                   class="absolute top-full z-10 mt-3 w-screen max-w-md overflow-hidden rounded-3xl bg-white shadow-lg ring-1 ring-gray-900/5"                 >                   <div class="p-4">                     <div v-for="(child, childIndex) in item.children" :key="childIndex" class="group relative flex items-center gap-x-6 rounded-lg p-4 text-sm leading-6 hover:bg-gray-50">                       <div :data-sgpt-block="item.id" class="flex-auto">                         <a @click="handleMenuItemClick" :href="child.link ?? null" class="block font-semibold text-gray-900">                           {{ child.title }}                         </a>                         <p v-if="child.subtitle" class="mt-1 text-gray-600" v-text="child.subtitle" />                       </div>                     </div>                   </div>                 </div>               </transition>             </div>              <a               v-else               @click="handleMenuItemClick"               :href="item.link ?? null"               :class="colors.text" class="text-sm font-semibold leading-6"               v-text="item.title"               :data-sgpt-block="item.id"             />           </template>         </div>       </template>     </nav>          <div v-if="menuItems.length && mobileMenuOpen" class="lg:hidden" role="dialog" aria-modal="true">       <div @click="mobileMenuOpen = false" class="fixed inset-0 z-10 bg-black opacity-30"></div>        <div class="fixed inset-y-0 right-0 z-10 w-full overflow-y-auto bg-white px-6 py-6 sm:max-w-sm sm:ring-1 sm:ring-gray-900/10">         <div class="flex items-center justify-between">           <a href="/" class="flex items-center gap-3">             <img v-if="settings.logo?.filename" :src="settings.logo.filename" class="h-8 w-auto" alt="">           </a>           <button @click="mobileMenuOpen = false" type="button" class="-m-2.5 rounded-md p-2.5 text-gray-700">             <span class="sr-only">Close menu</span>             <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">               <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />             </svg>           </button>         </div>         <div class="mt-6 flow-root">           <div class="-my-6 divide-y divide-gray-500/10">             <div class="space-y-2 py-6">               <template v-for="(item, index) in menuItems" :key="index">                 <div v-if="item.children.length" class="-mx-3">                   <button                     @click="toggleSubmenu(item.id)"                     type="button"                     class="flex w-full items-center justify-between rounded-lg py-2 pl-3 pr-3.5 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50"                     aria-controls="disclosure-1"                     aria-expanded="false"                     :data-sgpt-block="item.id"                   >                     {{ item.title }}                     <svg                       :class="{'rotate-180': activeSubmenu === item.id}"                       class="h-5 w-5 flex-none transition ease-out duration-200"                       viewBox="0 0 20 20"                       fill="currentColor"                       aria-hidden="true"                     >                       <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />                     </svg>                   </button>                                      <div v-show="activeSubmenu === item.id" class="mt-2 space-y-2">                     <a                        v-for="(child, childIndex) in item.children"                       :key="childIndex"                       :href="child.link ?? null"                       class="block rounded-lg py-2 pl-6 pr-3 text-sm font-semibold leading-7 text-gray-900 hover:bg-gray-50"                       v-text="child.title"                       @click="$event => {                         mobileMenuOpen = false;                         handleMenuItemClick($event);                       }"                       :data-sgpt-block="child.id"                     />                   </div>                 </div>                 <a                   v-else                   @click="$event => {                     mobileMenuOpen = false;                     handleMenuItemClick($event);                   }"                   :href="item.link ?? null"                   class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50"                   v-text="item.title"                   :data-sgpt-block="item.id"                 />               </template>             </div>           </div>         </div>       </div>     </div>   </header> </template><script> export default {   props: {     index: {       type: Number,       default: 0     },     schema: {       type: Object,       default: () => ({})     }   },    data() {     return {       activeSubmenu: null,       mobileMenuOpen: false,       submenuPositions: {}     }   },    watch: {     activeSubmenu(id) {       if (!id) {         return;       }        this.submenuPositions[id] = null;              setTimeout(() => {         const submenu = this.$refs[`submenu-${id}`];          if (!submenu) {           return;         }          const position = submenu.getBoundingClientRect();                  if ((position.x + position.width) > window.outerWidth) {           this.submenuPositions[id] = '-right-8';         } else {           this.submenuPositions[id] = '-left-8';         }       }, 1);     }   },    computed: {     settings() {       const data = {};        this.schema.settings?.forEach((setting) => {         data[setting.id] = setting.value;       });        return data;     },      blocks() {       const blocks = this.schema.blocks?.map((block) => {         const data = {           id: block.id,           type: block.type         };          block.settings.forEach((setting) => {           data[setting.id] = setting.value;         });          return data;       });        return blocks ?? [];     },      /**      * Compute section colors based on settings.      */     colors() {       return themeColors(this.settings.theme)     },      /**      * Compute menu items.      * @returns {Array}      */     menuItems() {       const items = [];        /* Collect parent items. */       this.blocks.forEach((block) => {         if (block.type !== 'menu_item') {           return;         }          block.children = [];         items.push(block);       });        /* Collect child items. */       this.blocks.forEach((block) => {         if (block.type !== 'child_item' || !block.parent) {           return;         }          const parent = items.find((item) => item.id === block.parent);          if (!parent) {           return;         }          parent.children.push(block);       });              return items;     }   },    methods: {     getResizeUrl,          /**      * Toggle active submenu.      * @param {String} id       */     toggleSubmenu(id) {       if (this.activeSubmenu === id) {         this.activeSubmenu = null;         return;       }        this.activeSubmenu = id;     },      handleMenuItemClick(event) {       const href = event.target.getAttribute('href');        if (!href || !href.startsWith('#')) {         return;       }        event.preventDefault();       const target = document.querySelector(href);        if (!target) {         return;       }        target.scrollIntoView({         behavior: 'smooth',         block: 'start',         inline: 'nearest'       });     }   } }; </script><style> </style>